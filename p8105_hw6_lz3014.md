TEST_p8105_hw6
================
2024-12-2

``` r
library(tidyverse)
library(modelr)

set.seed(1202)
```

# Problem 1

``` r
weather_df = 
  rnoaa::meteo_pull_monitors(
    c("USW00094728"),
    var = c("PRCP", "TMIN", "TMAX"), 
    date_min = "2017-01-01",
    date_max = "2017-12-31") |>
  mutate(
    name = recode(id, USW00094728 = "CentralPark_NY"),
    tmin = tmin / 10,
    tmax = tmax / 10) |>
  select(name, id, everything())
```

    ## using cached file: C:\Users\CC\AppData\Local/R/cache/R/rnoaa/noaa_ghcnd/USW00094728.dly

    ## date created (size, mb): 2024-12-01 20:39:19.95446 (8.685)

    ## file min/max dates: 1869-01-01 / 2024-11-30

### 1. A simple linear regression with tmax as the response and tmin as the predictor

``` r
lm_fit <- lm(tmax ~ tmin, data = weather_df)
```

### 2. Use 5000 bootstrap samples and produce estimates of $\hat{r}^2$ and $\log(\hat{\beta}_0 * \hat{\beta}_1)$

``` r
bootstrap_function <- function(data) {
  boot_sample <- sample_frac(data, replace = TRUE)
  
  boot_fit <- lm(tmax ~ tmin, data = boot_sample)

  glance_result <- broom::glance(boot_fit)
  r_squared <- glance_result$r.squared
  
  beta <- coef(boot_fit)
  log_beta_product <- log(beta[1] * beta[2])
  
  return(tibble(
    r_squared = r_squared, 
    log_beta_product = log_beta_product))
}
```

``` r
boot_straps_1 <- tibble(strap_number = 1:5000) |>
  mutate(
    strap_sample = map(strap_number, \(i) bootstrap_function(weather_df))
  ) |>
  unnest(strap_sample)

head(boot_straps_1, 5)
```

    ## # A tibble: 5 Ã— 3
    ##   strap_number r_squared log_beta_product
    ##          <int>     <dbl>            <dbl>
    ## 1            1     0.916             2.04
    ## 2            2     0.910             2.00
    ## 3            3     0.900             2.02
    ## 4            4     0.923             2.01
    ## 5            5     0.909             2.04

### 3. Plot the distribution of estimates

``` r
ggplot(boot_straps_1, aes(x = r_squared)) +
  geom_density(color = "black", fill = "skyblue", alpha = 0.5) +
  labs(
    title = "Bootstrap Density Distribution of R-squared",
    x = "R-squared",
    y = "Density"
  )
```

![](p8105_hw6_lz3014_files/figure-gfm/unnamed-chunk-6-1.png)<!-- -->

``` r
ggplot(boot_straps_1, aes(x = log_beta_product)) +
  geom_density(color = "black", fill = "skyblue", alpha = 0.5) +
  labs(
    title = "Bootstrap Density Distribution of Log_beta_product",
    x = "Log_beta_product",
    y = "Density"
  )
```

![](p8105_hw6_lz3014_files/figure-gfm/unnamed-chunk-6-2.png)<!-- -->

**Description:**  
- $\hat{r}^2$: The distribution is bell-shaped, centered around 0.91,
indicating that most R-squared estimates are concentrated near this
value.  
- $\log(\hat{\beta}_0 * \hat{\beta}_1)$: The distribution is
bell-shaped, centered around 2.02, indicating that most log estimates
are concentrated near this value.

### Identify the 2.5% and 97.5% quantiles to provide a 95% confidence interval for $\hat{r}^2$ and $\log(\hat{\beta}_0 * \hat{\beta}_1)$

``` r
# 95% CI
ci_r_squared <- quantile(boot_straps_1$r_squared, c(0.025, 0.975))
ci_log_beta_product <- quantile(boot_straps_1$log_beta_product, c(0.025, 0.975))

ci_r_squared
```

    ##      2.5%     97.5% 
    ## 0.8939925 0.9269135

``` r
ci_log_beta_product
```

    ##     2.5%    97.5% 
    ## 1.964846 2.058595

- CI of r_squared: (0.8939448, 0.9271188)  
- CI of log_beta_product: (1.964509, 2.058203)
